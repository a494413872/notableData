---
tags: [java/基础知识]
title: 读写分离数据一致性问题
created: '2020-04-29T06:23:38.706Z'
modified: '2020-04-29T09:04:24.106Z'
---

# 读写分离数据一致性问题
读写分离有可能导致插入的数据还没有被同步到从库，然后马上去查询从库，查询不到数据的问题

目前的解决方案是，通过拦截器的方式，在更新数据库的时候，在threadLocal里面添加一个标志位，和一个同步时间，并且通过调用链一路传递下去，当需要查询的时候，通过aop切面的方式，和当前系统时间，计算出是否需要强制走写库，如果需要的话，就强制走主库。
